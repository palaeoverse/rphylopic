<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Advanced examples in ggplot • rphylopic</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Advanced examples in ggplot">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">rphylopic</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.5.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/a-getting-started.html">Getting started with rphylopic</a></li>
    <li><a class="dropdown-item" href="../articles/b-advanced-ggplot.html">Advanced examples in ggplot</a></li>
    <li><a class="dropdown-item" href="../articles/c-advanced-base.html">Advanced examples in base R</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/palaeoverse/rphylopic/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Advanced examples in ggplot</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/palaeoverse/rphylopic/blob/main/vignettes/b-advanced-ggplot.Rmd" class="external-link"><code>vignettes/b-advanced-ggplot.Rmd</code></a></small>
      <div class="d-none name"><code>b-advanced-ggplot.Rmd</code></div>
    </div>

    
    
<p><strong>Authors:</strong> William Gearty &amp; Lewis A. Jones</p>
<p><strong>Last updated:</strong> 2024-10-02</p>
<div style="text-align: justify">
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>Herein we provide three example applications of the
<strong>rphylopic</strong> package in combination with the
<a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a> package. However, note that all demonstrated
functionality is also available for base R and showcased in a <a href="c-advanced-base.html">separate vignette</a>.</p>
</div>
<div class="section level2">
<h2 id="basic-accession-and-transformation">Basic accession and transformation<a class="anchor" aria-label="anchor" href="#basic-accession-and-transformation"></a>
</h2>
<p>The <strong>rphylopic</strong> package provides robust and flexible
tools to access and transform PhyloPic silhouettes. Here we demonstrate
this using the example dataset of Antarctic penguins from the
<a href="https://allisonhorst.github.io/palmerpenguins/" class="external-link">palmerpenguins</a> R package.</p>
<p>First, let’s load our libraries and the penguin data:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load libraries</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rphylopic.palaeoverse.org">rphylopic</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://allisonhorst.github.io/palmerpenguins/" class="external-link">palmerpenguins</a></span><span class="op">)</span></span>
<span><span class="co"># Get penguin data and clean it</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">penguins</span><span class="op">)</span></span>
<span><span class="va">penguins_subset</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">penguins</span>, <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">sex</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Now, let’s pick a silhouette to use for the penguins. Let’s pick
#2:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Pick a silhouette for Pygoscelis (here we pick #2)</span></span>
<span><span class="va">penguin</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pick_phylopic.html">pick_phylopic</a></span><span class="op">(</span><span class="st">"Pygoscelis"</span>, n <span class="op">=</span> <span class="fl">3</span>, view <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<p>You may have noticed in the preview that the silhouette was a little
slanted. Let’s rotate it clockwise just a smidgen:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># It's a little slanted, so let's rotate it a little bit</span></span>
<span><span class="va">penguin_rot</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rotate_phylopic.html">rotate_phylopic</a></span><span class="op">(</span>img <span class="op">=</span> <span class="va">penguin</span>, angle <span class="op">=</span> <span class="fl">15</span><span class="op">)</span></span></code></pre></div>
<p>Now, let’s draft the plot that we want to make. In this case, let’s
plot the penguins’ bill lengths vs. their flipper lengths:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">penguins_subset</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">bill_length_mm</span>, y <span class="op">=</span> <span class="va">flipper_length_mm</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Bill length (mm)"</span>, y <span class="op">=</span> <span class="st">"Flipper length (mm)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">species</span>, ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">15</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="ggplot-penguin-plot-1-1.png" alt="plot of chunk ggplot-penguin-plot-1" width="100%"><p class="caption">
plot of chunk ggplot-penguin-plot-1
</p>
</div>
<p>That’s a nice basic plot! But you know what would make it nicer? If
we added a penguin silhouette to the plot. Sadly, we don’t have a
different silhouette for each species (although we could make one…), so
let’s just go with putting a single silhouette in the top panel. We’ll
use the <code><a href="../reference/geom_phylopic.html">geom_phylopic()</a></code> function, which will require us to
make a <code>data.frame</code>. Note that the <code>x</code> and
<code>y</code> aesthetics specify the center of the silhouette, and the
<code>height</code> argument specifies how tall the silhouette is in the
units of the y-axis.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">silhouette_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">59</span>, y <span class="op">=</span> <span class="fl">215</span>, species <span class="op">=</span> <span class="st">"Adelie"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">penguins_subset</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">bill_length_mm</span>, y <span class="op">=</span> <span class="va">flipper_length_mm</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/geom_phylopic.html">geom_phylopic</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">silhouette_df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span><span class="op">)</span>, height <span class="op">=</span> <span class="fl">30</span>,</span>
<span>                img <span class="op">=</span> <span class="va">penguin_rot</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Bill length (mm)"</span>, y <span class="op">=</span> <span class="st">"Flipper length (mm)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">species</span>, ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">15</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="ggplot-penguin-plot-2-1.png" alt="plot of chunk ggplot-penguin-plot-2" width="100%"><p class="caption">
plot of chunk ggplot-penguin-plot-2
</p>
</div>
<p>Isn’t that nifty! We can go a step further, though. What if we used
little penguins instead of points?! To do that, we can use the
<code><a href="../reference/geom_phylopic.html">geom_phylopic()</a></code> function instead of the
<code><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point()</a></code> function (in this case, we want to use the
same image for each x-y pair):</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">penguins_subset</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/geom_phylopic.html">geom_phylopic</a></span><span class="op">(</span>img <span class="op">=</span> <span class="va">penguin_rot</span>,</span>
<span>                <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">bill_length_mm</span>, y <span class="op">=</span> <span class="va">flipper_length_mm</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Bill length (mm)"</span>, y <span class="op">=</span> <span class="st">"Flipper length (mm)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">species</span>, ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">15</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="ggplot-penguin-plot-3-1.png" alt="plot of chunk ggplot-penguin-plot-3" width="100%"><p class="caption">
plot of chunk ggplot-penguin-plot-3
</p>
</div>
<p>The default silhouette size for <code><a href="../reference/geom_phylopic.html">geom_phylopic()</a></code> is as
large as will fit within the plot area. That won’t work well here.
Instead, we can specify a <code>height</code> or <code>width</code> to
use (in y-axis or x-axis units, respectively):</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">penguins_subset</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/geom_phylopic.html">geom_phylopic</a></span><span class="op">(</span>img <span class="op">=</span> <span class="va">penguin_rot</span>,</span>
<span>                <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">bill_length_mm</span>, y <span class="op">=</span> <span class="va">flipper_length_mm</span><span class="op">)</span>, height <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Bill length (mm)"</span>, y <span class="op">=</span> <span class="st">"Flipper length (mm)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">species</span>, ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">15</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="ggplot-penguin-plot-3b-1.png" alt="plot of chunk ggplot-penguin-plot-3b" width="100%"><p class="caption">
plot of chunk ggplot-penguin-plot-3b
</p>
</div>
<p>Alternatively, we can vary the height based on some other aspect of
data, and the values will be automatically scaled for us. In this case,
let’s try making the size of the silhouettes relative to the penguins’
body masses. Behind the scenes, <strong>rphylopic</strong> will work its
magic and rescale them to values between 1 and 6. Note that, depending
on your own data, you may want to customize how the values are scaled by
using <code><a href="../reference/scales.html">scale_height_continuous()</a></code> (or
<code><a href="../reference/scales.html">scale_width_continuous()</a></code> if you are using the
<code>width</code> aesthetic) just as you would use
<code><a href="https://ggplot2.tidyverse.org/reference/scale_size.html" class="external-link">scale_size_continuous()</a></code>. We’ll just use the defaults
here:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">penguins_subset</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/geom_phylopic.html">geom_phylopic</a></span><span class="op">(</span>img <span class="op">=</span> <span class="va">penguin_rot</span>,</span>
<span>                <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">bill_length_mm</span>, y <span class="op">=</span> <span class="va">flipper_length_mm</span>,</span>
<span>                    height <span class="op">=</span> <span class="va">body_mass_g</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Bill length (mm)"</span>, y <span class="op">=</span> <span class="st">"Flipper length (mm)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">species</span>, ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">15</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="ggplot-penguin-plot-4-1.png" alt="plot of chunk ggplot-penguin-plot-4" width="100%"><p class="caption">
plot of chunk ggplot-penguin-plot-4
</p>
</div>
<p>Nice! Finally, let’s give the female and male penguins different fill
colors. Note that the default for <code><a href="../reference/geom_phylopic.html">geom_phylopic()</a></code> is to not
display a legend, so we need to set <code>show.legend = TRUE</code>.
However, we only want a legend for the fill colors, so we use
<code>guide = "none"</code> for the size scale. We also want to show the
fill color in the legend, so we need to override the shape:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">penguins_subset</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/geom_phylopic.html">geom_phylopic</a></span><span class="op">(</span>img <span class="op">=</span> <span class="va">penguin_rot</span>,</span>
<span>                <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">bill_length_mm</span>, y <span class="op">=</span> <span class="va">flipper_length_mm</span>,</span>
<span>                    height <span class="op">=</span> <span class="va">body_mass_g</span>, fill <span class="op">=</span> <span class="va">sex</span><span class="op">)</span>,</span>
<span>                show.legend <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Bill length (mm)"</span>, y <span class="op">=</span> <span class="st">"Flipper length (mm)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_size.html" class="external-link">scale_size_continuous</a></span><span class="op">(</span>guide <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span><span class="st">"Sex"</span>, values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"orange"</span>, <span class="st">"blue"</span><span class="op">)</span>,</span>
<span>                     labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Female"</span>, <span class="st">"Male"</span><span class="op">)</span>,</span>
<span>                     guide <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_legend.html" class="external-link">guide_legend</a></span><span class="op">(</span>override.aes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>shape <span class="op">=</span> <span class="fl">21</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">species</span>, ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">15</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"inside"</span>, legend.position.inside <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.9</span>, <span class="fl">0.9</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="ggplot-penguin-plot-5-1.png" alt="plot of chunk ggplot-penguin-plot-5" width="100%"><p class="caption">
plot of chunk ggplot-penguin-plot-5
</p>
</div>
<p>Hmm…the colored dots in the legend are great, but lucky for us, the
package also supplies a convenient way to include silhouettes in the
legend. Due to technical constraints, you’ll need to specify the
images/uuids/names again within <code><a href="../reference/phylopic_key_glyph.html">phylopic_key_glyph()</a></code>. If
you supply more than one silhouette to this function, it will cycle
through them as it generates legend keys (recycling as needed). Note
that <code><a href="../reference/phylopic_key_glyph.html">phylopic_key_glyph()</a></code> does not currently support the
<code>height</code>/<code>width</code> aesthetics.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">penguins_subset</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/geom_phylopic.html">geom_phylopic</a></span><span class="op">(</span>img <span class="op">=</span> <span class="va">penguin_rot</span>,</span>
<span>                <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">bill_length_mm</span>, y <span class="op">=</span> <span class="va">flipper_length_mm</span>,</span>
<span>                    height <span class="op">=</span> <span class="va">body_mass_g</span>, fill <span class="op">=</span> <span class="va">sex</span><span class="op">)</span>,</span>
<span>                show.legend <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                key_glyph <span class="op">=</span> <span class="fu"><a href="../reference/phylopic_key_glyph.html">phylopic_key_glyph</a></span><span class="op">(</span>img <span class="op">=</span> <span class="va">penguin_rot</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Bill length (mm)"</span>, y <span class="op">=</span> <span class="st">"Flipper length (mm)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_size.html" class="external-link">scale_size_continuous</a></span><span class="op">(</span>guide <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span><span class="st">"Sex"</span>, values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"orange"</span>, <span class="st">"blue"</span><span class="op">)</span>,</span>
<span>                     labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Female"</span>, <span class="st">"Male"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">species</span>, ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">15</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"inside"</span>, legend.position.inside <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.9</span>, <span class="fl">0.9</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="ggplot-penguin-plot-6-1.png" alt="plot of chunk ggplot-penguin-plot-6" width="100%"><p class="caption">
plot of chunk ggplot-penguin-plot-6
</p>
</div>
<p>Now that’s a nice figure!</p>
</div>
<div class="section level2">
<h2 id="geographic-distribution">Geographic distribution<a class="anchor" aria-label="anchor" href="#geographic-distribution"></a>
</h2>
<p>In much the same way as generic x-y plotting, the
<strong>rphylopic</strong> package can be used in combination with
<a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a> to plot organism silhouettes on a map. That is,
to plot data points (e.g., species occurrences) as silhouettes. We
provide an example here of how this might be achieved. For this
application, we use the example occurrence dataset of early
(Carboniferous to Early Triassic) tetrapods from the
<a href="https://palaeoverse.palaeoverse.org" class="external-link">palaeoverse</a> R package to visualize the geographic
distribution of <em>Diplocaulus</em> fossils.</p>
<p>First, let’s load our libraries and the tetrapod data:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load libraries</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rphylopic.palaeoverse.org">rphylopic</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://palaeoverse.palaeoverse.org" class="external-link">palaeoverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/" class="external-link">sf</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/adeckmyn/maps" class="external-link">maps</a></span><span class="op">)</span></span>
<span><span class="co"># Get occurrence data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">tetrapods</span><span class="op">)</span></span></code></pre></div>
<p>Then we’ll subset our occurrences to only those for
<em>Diplocaulus</em>:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Subset to desired group</span></span>
<span><span class="va">tetrapods</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">tetrapods</span>, <span class="va">genus</span> <span class="op">==</span> <span class="st">"Diplocaulus"</span><span class="op">)</span></span></code></pre></div>
<p>Now, let’s plot those occurrences on a world map.
<a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a> and it’s built-in function
<code><a href="https://ggplot2.tidyverse.org/reference/map_data.html" class="external-link">map_data()</a></code> make this a breeze. Note that we use
<code>alpha = 0.75</code> in case there are multiple occurrences in the
same place. That way, the darker the fill color, the more occurrences in
that geographic location.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Get map data</span></span>
<span><span class="va">world</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_as_sf.html" class="external-link">st_as_sf</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/maps/man/map.html" class="external-link">map</a></span><span class="op">(</span><span class="st">"world"</span>, fill <span class="op">=</span> <span class="cn">TRUE</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">world</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_transform.html" class="external-link">st_wrap_dateline</a></span><span class="op">(</span><span class="va">world</span><span class="op">)</span></span>
<span><span class="co"># Make map</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">world</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"lightgray"</span>, color <span class="op">=</span> <span class="st">"darkgrey"</span>, linewidth <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">tetrapods</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">lng</span>, y <span class="op">=</span> <span class="va">lat</span><span class="op">)</span>,</span>
<span>             height <span class="op">=</span> <span class="fl">4</span>, alpha <span class="op">=</span> <span class="fl">0.75</span>, fill <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_void</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">coord_sf</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="ggplot-geog-plot-1-1.png" alt="plot of chunk ggplot-geog-plot-1" width="100%"><p class="caption">
plot of chunk ggplot-geog-plot-1
</p>
</div>
<p>Now, as with the penguin figure above, we can easily replace those
points with silhouettes.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">world</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"lightgray"</span>, color <span class="op">=</span> <span class="st">"darkgrey"</span>, linewidth <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/geom_phylopic.html">geom_phylopic</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">tetrapods</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">lng</span>, y <span class="op">=</span> <span class="va">lat</span>, name <span class="op">=</span> <span class="va">genus</span><span class="op">)</span>,</span>
<span>                height <span class="op">=</span> <span class="fl">4</span>, alpha <span class="op">=</span> <span class="fl">0.75</span>, fill <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_void</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">coord_sf</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="ggplot-geog-plot-2-1.png" alt="plot of chunk ggplot-geog-plot-2" width="100%"><p class="caption">
plot of chunk ggplot-geog-plot-2
</p>
</div>
<p>Snazzy!</p>
<p>Note that while we used the genus name as the <code>name</code>
aesthetic here, we easily could have done
<code>name = "Diplocaulus"</code> outside of the <code><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes()</a></code> call
instead. However, if we were plotting occurrences of multiple genera,
we’d definitely want to plot them as different silhouettes using
<code>name = genus</code> within the <code><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes()</a></code> call.</p>
<p>Also, note that we could change the projection of the map and data
using the <code>crs</code> and <code>default_crs</code> arguments in
<code><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">coord_sf()</a></code>. When projecting data, note that the y-axis
limits will change to projected limits. For example, in the Robinson
projection, the y-axis limits are roughly -8,600,000 and 8,600,000 in
projected coordinates. Therefore, you may need to adjust the
<code>height</code> argument/aesthetic accordingly when projecting maps
and data.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Set up a bounding box</span></span>
<span><span class="va">bbox</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_graticule.html" class="external-link">st_graticule</a></span><span class="op">(</span>crs <span class="op">=</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_crs.html" class="external-link">st_crs</a></span><span class="op">(</span><span class="st">"ESRI:54030"</span><span class="op">)</span>,</span>
<span>                     lat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">89.9</span>, <span class="fl">89.9</span><span class="op">)</span>, lon <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">179.9</span>, <span class="fl">179.9</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">world</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"lightgray"</span>, color <span class="op">=</span> <span class="st">"darkgrey"</span>, linewidth <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/geom_phylopic.html">geom_phylopic</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">tetrapods</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">lng</span>, y <span class="op">=</span> <span class="va">lat</span>, name <span class="op">=</span> <span class="va">genus</span><span class="op">)</span>,</span>
<span>                height <span class="op">=</span> <span class="fl">4E5</span>, alpha <span class="op">=</span> <span class="fl">0.75</span>, fill <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">bbox</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_void</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">coord_sf</a></span><span class="op">(</span>default_crs <span class="op">=</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_crs.html" class="external-link">st_crs</a></span><span class="op">(</span><span class="fl">4326</span><span class="op">)</span>, crs <span class="op">=</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_crs.html" class="external-link">st_crs</a></span><span class="op">(</span><span class="st">"ESRI:54030"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="ggplot-geog-plot-3-1.png" alt="plot of chunk ggplot-geog-plot-3" width="100%"><p class="caption">
plot of chunk ggplot-geog-plot-3
</p>
</div>
</div>
<div class="section level2">
<h2 id="phylogenetics">Phylogenetics<a class="anchor" aria-label="anchor" href="#phylogenetics"></a>
</h2>
<p>Another common use case of PhyloPic silhouettes is to represent
taxonomic information. In this example, we demonstrate how to use
silhouettes within a phylogenetic framework. In this case, the
phylogeny, taken from the <a href="https://github.com/liamrevell/phytools" class="external-link">phytools</a> package, includes taxa
across all vertebrates. Even many taxonomic experts are unlikely to know
the scientific names of these 11 disparate taxa, so we’ll replace the
names with PhyloPic silhouettes. First, let’s load our libraries and
data:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load libraries</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rphylopic.palaeoverse.org">rphylopic</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/liamrevell/phytools" class="external-link">phytools</a></span><span class="op">)</span></span>
<span><span class="co"># Get vertebrate phylogeny and data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">vertebrate.tree</span><span class="op">)</span></span></code></pre></div>
<p>We can use a vectorized version of the <code><a href="../reference/get_uuid.html">get_uuid()</a></code>
function to retrieve UUID values for all of the species at once.
However, just in case we get an error, we wrap the
<code><a href="../reference/get_uuid.html">get_uuid()</a></code> call in a <code><a href="https://rdrr.io/r/base/conditions.html" class="external-link">tryCatch()</a></code> call. This
way, we should get either a UUID or <code>NA</code> for each
species:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Make a data.frame for the PhyloPic names</span></span>
<span><span class="va">vertebrate_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>species <span class="op">=</span> <span class="va">vertebrate.tree</span><span class="op">$</span><span class="va">tip.label</span>, uuid <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span></span>
<span><span class="co"># Try to get PhyloPic UUIDs for the species names</span></span>
<span><span class="va">vertebrate_data</span><span class="op">$</span><span class="va">uuid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">vertebrate.tree</span><span class="op">$</span><span class="va">tip.label</span>,</span>
<span>                               <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>                                 <span class="kw"><a href="https://rdrr.io/r/base/conditions.html" class="external-link">tryCatch</a></span><span class="op">(</span><span class="fu"><a href="../reference/get_uuid.html">get_uuid</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, error <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">e</span><span class="op">)</span> <span class="cn">NA</span><span class="op">)</span></span>
<span>                               <span class="op">}</span><span class="op">)</span></span>
<span><span class="va">vertebrate_data</span></span></code></pre></div>
<pre><code><span><span class="co">##                   species                                 uuid</span></span>
<span><span class="co">## 1  Carcharodon_carcharias 00f208a3-887d-4ae8-838c-2124f53b9fc1</span></span>
<span><span class="co">## 2       Carassius_auratus abcb9d2c-db21-4b63-b8e7-b770b11ad288</span></span>
<span><span class="co">## 3     Latimeria_chalumnae 12c38a8a-6d68-4af3-ada3-05cafdfc25c2</span></span>
<span><span class="co">## 4            Homo_sapiens 9c6af553-390c-4bdd-baeb-6992cbc540b1</span></span>
<span><span class="co">## 5             Lemur_catta 8a187391-82a3-4d9b-a402-3a310bf7dc38</span></span>
<span><span class="co">## 6        Myotis_lucifugus                                 &lt;NA&gt;</span></span>
<span><span class="co">## 7              Sus_scrofa 3d8acaf6-4355-491e-8e86-4a411b53b98b</span></span>
<span><span class="co">## 8  Megaptera_novaeangliae 012afb33-55c3-4fc6-9ae3-3a91fda32fd5</span></span>
<span><span class="co">## 9              Bos_taurus dc5c561e-e030-444d-ba22-3d427b60e58a</span></span>
<span><span class="co">## 10          Iguana_iguana 5dec03d9-66a2-4033-b1a9-6dbb3485199f</span></span>
<span><span class="co">## 11     Turdus_migratorius 83b29bf0-f4f9-412d-8b3b-7faf4febd69d</span></span></code></pre>
<p>Oh no, we weren’t able to find a silhouette for <em>Myotis
lucifugus</em> (little brown bat)! Good thing we used
<code><a href="https://rdrr.io/r/base/conditions.html" class="external-link">tryCatch()</a></code>! Given the coarse resolution of this phylogeny,
we can just grab a silhouette for the subfamily (Vespertilioninae):</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">vertebrate_data</span><span class="op">$</span><span class="va">uuid</span><span class="op">[</span><span class="va">vertebrate_data</span><span class="op">$</span><span class="va">species</span> <span class="op">==</span> <span class="st">"Myotis_lucifugus"</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/get_uuid.html">get_uuid</a></span><span class="op">(</span><span class="st">"Vespertilioninae"</span><span class="op">)</span></span></code></pre></div>
<p>I’m also not a huge fan of the boar picture. Let’s choose an
alternative with <code><a href="../reference/pick_phylopic.html">pick_phylopic()</a></code>.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Pick a different boar image; we'll pick #2</span></span>
<span><span class="va">boar_svg</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pick_phylopic.html">pick_phylopic</a></span><span class="op">(</span><span class="st">"Sus scrofa"</span>, view <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span><span class="co"># Extract the UUID</span></span>
<span><span class="va">vertebrate_data</span><span class="op">$</span><span class="va">uuid</span><span class="op">[</span><span class="va">vertebrate_data</span><span class="op">$</span><span class="va">species</span> <span class="op">==</span> <span class="st">"Sus_scrofa"</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">boar_svg</span>, <span class="st">"uuid"</span><span class="op">)</span></span></code></pre></div>
<p>Now that we’ve got our phylogeny and UUIDs, we could go ahead and
create our figure. However, time for a quick aside. The time required
for <code><a href="../reference/geom_phylopic.html">geom_phylopic()</a></code> and the other
<strong>rphylopic</strong> visualization functions scales with the
number of <em>unique</em> names/UUIDs, not the number of plotted
silhouettes. Therefore, if you are plotting a lot of <em>different</em>
silhouettes, these functions can take quite a long time to poll PhyloPic
for each unique name, download the silhouettes, and convert them to be
added to the plot. If you plan to use the same silhouettes for multiple
figures, we strongly suggest that you poll PhyloPic yourself using
<code><a href="../reference/get_phylopic.html">get_phylopic()</a></code> or <code><a href="../reference/pick_phylopic.html">pick_phylopic()</a></code>, save the
silhouettes to your R environment, and then these use image objects in
the visualization functions (with the <code>img</code>
argument/aesthetic). Following this advice, let’s get image objects for
these 11 species before we make our figure. Note that, since we’ve used
<code><a href="../reference/get_uuid.html">get_uuid()</a></code> to get these 11 UUIDs, we know that they are
valid, so we don’t need to catch any errors this time.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">vertebrate_data</span><span class="op">$</span><span class="va">svg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">vertebrate_data</span><span class="op">$</span><span class="va">uuid</span>, <span class="va">get_phylopic</span><span class="op">)</span></span></code></pre></div>
<p>Now let’s go ahead and plot our phylogeny with the <a href="https://www.bioconductor.org/packages/ggtree" class="external-link">ggtree</a>
package:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://www.amazon.com/Integration-Manipulation-Visualization-Phylogenetic-Computational-ebook/dp/B0B5NLZR1Z/" class="external-link">ggtree</a></span><span class="op">)</span></span>
<span><span class="co"># Plot the tree</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/ggtree/man/ggtree.html" class="external-link">ggtree</a></span><span class="op">(</span><span class="va">vertebrate.tree</span>, size <span class="op">=</span> <span class="fl">1</span>, layout <span class="op">=</span> <span class="st">"circular"</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="ggplot-phylo-plot-1-1.png" alt="plot of chunk ggplot-phylo-plot-1" width="100%"><p class="caption">
plot of chunk ggplot-phylo-plot-1
</p>
</div>
<p>Hmm…that’s a bit boring. Let’s add a geological timescale to the
background using <code><a href="https://williamgearty.com/deeptime/reference/coord_geo_polar.html" class="external-link">coord_geo_polar()</a></code> from the
<a href="https://williamgearty.com/deeptime/" class="external-link">deeptime</a> package. Note that we need to use the
<code><a href="https://rdrr.io/pkg/ggtree/man/revts.html" class="external-link">revts()</a></code> function to reverse the time axis to work with
<code><a href="https://williamgearty.com/deeptime/reference/coord_geo_polar.html" class="external-link">coord_geo_polar()</a></code>.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://williamgearty.com/deeptime/" class="external-link">deeptime</a></span><span class="op">)</span></span>
<span><span class="co"># Plot the tree with a geological timescale in the background</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/ggtree/man/revts.html" class="external-link">revts</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/ggtree/man/ggtree.html" class="external-link">ggtree</a></span><span class="op">(</span><span class="va">vertebrate.tree</span>, size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">500</span>, <span class="fl">0</span>, <span class="fl">100</span><span class="op">)</span>,</span>
<span>                     labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">500</span>, <span class="fl">0</span>, <span class="op">-</span><span class="fl">100</span><span class="op">)</span>,</span>
<span>                     limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">500</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>                     expand <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/expansion.html" class="external-link">expansion</a></span><span class="op">(</span>mult <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>guide <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://williamgearty.com/deeptime/reference/coord_geo_radial.html" class="external-link">coord_geo_radial</a></span><span class="op">(</span>dat <span class="op">=</span> <span class="st">"periods"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="ggplot-phylo-plot-2-1.png" alt="plot of chunk ggplot-phylo-plot-2" width="100%"><p class="caption">
plot of chunk ggplot-phylo-plot-2
</p>
</div>
<p>That’s looking a lot prettier! Let’s go ahead and add our silhouettes
now. Note that we need to attach the <code>vertebrate_data</code> object
with the <code>%&lt;+%</code> operator from <a href="https://www.amazon.com/Integration-Manipulation-Visualization-Phylogenetic-Computational-ebook/dp/B0B5NLZR1Z/" class="external-link">ggtree</a>.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/ggtree/man/revts.html" class="external-link">revts</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/ggtree/man/ggtree.html" class="external-link">ggtree</a></span><span class="op">(</span><span class="va">vertebrate.tree</span>, size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/ggfun/man/attacher.html" class="external-link">%&lt;+%</a></span> <span class="va">vertebrate_data</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/geom_phylopic.html">geom_phylopic</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>img <span class="op">=</span> <span class="va">svg</span><span class="op">)</span>, height <span class="op">=</span> <span class="fl">25</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">500</span>, <span class="fl">0</span>, <span class="fl">100</span><span class="op">)</span>,</span>
<span>                     labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">500</span>, <span class="fl">0</span>, <span class="op">-</span><span class="fl">100</span><span class="op">)</span>,</span>
<span>                     limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">500</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>                     expand <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/expansion.html" class="external-link">expansion</a></span><span class="op">(</span>mult <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>guide <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://williamgearty.com/deeptime/reference/coord_geo_radial.html" class="external-link">coord_geo_radial</a></span><span class="op">(</span>dat <span class="op">=</span> <span class="st">"periods"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="ggplot-phylo-plot-3-1.png" alt="plot of chunk ggplot-phylo-plot-3" width="100%"><p class="caption">
plot of chunk ggplot-phylo-plot-3
</p>
</div>
<p>Note that only a single height is specified and aspect ratio is
always maintained, hence why the silhouettes all have the same height
but different widths. Let’s fix some of the silhouettes by rotating them
90 degrees:</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">vertebrate_data</span><span class="op">$</span><span class="va">svg</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rotate_phylopic.html">rotate_phylopic</a></span><span class="op">(</span>img <span class="op">=</span> <span class="va">vertebrate_data</span><span class="op">$</span><span class="va">svg</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">vertebrate_data</span><span class="op">$</span><span class="va">svg</span><span class="op">[[</span><span class="fl">8</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rotate_phylopic.html">rotate_phylopic</a></span><span class="op">(</span>img <span class="op">=</span> <span class="va">vertebrate_data</span><span class="op">$</span><span class="va">svg</span><span class="op">[[</span><span class="fl">8</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<p>And now the finished product:</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/ggtree/man/revts.html" class="external-link">revts</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/ggtree/man/ggtree.html" class="external-link">ggtree</a></span><span class="op">(</span><span class="va">vertebrate.tree</span>, size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/ggfun/man/attacher.html" class="external-link">%&lt;+%</a></span> <span class="va">vertebrate_data</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/geom_phylopic.html">geom_phylopic</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>img <span class="op">=</span> <span class="va">svg</span><span class="op">)</span>, height <span class="op">=</span> <span class="fl">25</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">500</span>, <span class="fl">0</span>, <span class="fl">100</span><span class="op">)</span>,</span>
<span>                     labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">500</span>, <span class="fl">0</span>, <span class="op">-</span><span class="fl">100</span><span class="op">)</span>,</span>
<span>                     limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">500</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>                     expand <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/expansion.html" class="external-link">expansion</a></span><span class="op">(</span>mult <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>guide <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://williamgearty.com/deeptime/reference/coord_geo_radial.html" class="external-link">coord_geo_radial</a></span><span class="op">(</span>dat <span class="op">=</span> <span class="st">"periods"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="ggplot-phylo-plot-4-1.png" alt="plot of chunk ggplot-phylo-plot-4" width="100%"><p class="caption">
plot of chunk ggplot-phylo-plot-4
</p>
</div>
<p>Beautiful!</p>
</div>
</div>
<style type="text/css">
p.caption {
  display: none;
}
</style></main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://williamgearty.com" class="external-link">William Gearty</a>, <a href="https://www.lewisajones.com" class="external-link">Lewis A. Jones</a>, Scott Chamberlain.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
