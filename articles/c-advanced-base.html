<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Advanced examples in base R • rphylopic</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Advanced examples in base R">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">rphylopic</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.5.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/a-getting-started.html">Getting started with rphylopic</a></li>
    <li><a class="dropdown-item" href="../articles/b-advanced-ggplot.html">Advanced examples in ggplot</a></li>
    <li><a class="dropdown-item" href="../articles/c-advanced-base.html">Advanced examples in base R</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/palaeoverse/rphylopic/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Advanced examples in base R</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/palaeoverse/rphylopic/blob/main/vignettes/c-advanced-base.Rmd" class="external-link"><code>vignettes/c-advanced-base.Rmd</code></a></small>
      <div class="d-none name"><code>c-advanced-base.Rmd</code></div>
    </div>

    
    
<p><strong>Authors:</strong> William Gearty &amp; Lewis A. Jones</p>
<p><strong>Last updated:</strong> 2024-10-02</p>
<div style="text-align: justify">
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>Herein we provide three example applications of the
<strong>rphylopic</strong> package using base R. However, note that all
demonstrated functionality is also available for use with the
<a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a> package and showcased in a <a href="b-advanced-ggplot.html">separate vignette</a>.</p>
</div>
<div class="section level2">
<h2 id="basic-accession-and-transformation">Basic accession and transformation<a class="anchor" aria-label="anchor" href="#basic-accession-and-transformation"></a>
</h2>
<p>The <strong>rphylopic</strong> package provides robust and flexible
tools to access and transform PhyloPic silhouettes. Here we demonstrate
this using the example dataset of Antarctic penguins from the
<a href="https://allisonhorst.github.io/palmerpenguins/" class="external-link">palmerpenguins</a> R package.</p>
<p>First, let’s load our libraries and the penguin data:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load libraries</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rphylopic.palaeoverse.org">rphylopic</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://allisonhorst.github.io/palmerpenguins/" class="external-link">palmerpenguins</a></span><span class="op">)</span></span>
<span><span class="co"># Get penguin data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">penguins</span><span class="op">)</span></span></code></pre></div>
<p>Now, let’s pick a silhouette to use for the penguins. Let’s pick
#2:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Pick a silhouette for Pygoscelis (here we pick #2)</span></span>
<span><span class="va">penguin</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pick_phylopic.html">pick_phylopic</a></span><span class="op">(</span><span class="st">"Pygoscelis"</span>, n <span class="op">=</span> <span class="fl">3</span>, view <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<p>You may have noticed in the preview that the silhouette was a little
slanted. Let’s rotate it clockwise just a smidgen:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># It's a little slanted, so let's rotate it a little bit</span></span>
<span><span class="va">penguin_rot</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rotate_phylopic.html">rotate_phylopic</a></span><span class="op">(</span>img <span class="op">=</span> <span class="va">penguin</span>, angle <span class="op">=</span> <span class="fl">15</span><span class="op">)</span></span></code></pre></div>
<p>Now, let’s clean the data and split the data among the three
species:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Subset the data to remove rows with missing sex values</span></span>
<span><span class="va">penguins_subset</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">penguins</span>, <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">sex</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># Split the data by species</span></span>
<span><span class="va">species_split</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/split.html" class="external-link">split</a></span><span class="op">(</span><span class="va">penguins_subset</span>, <span class="va">penguins_subset</span><span class="op">$</span><span class="va">species</span><span class="op">)</span></span></code></pre></div>
<p>Now we’re going to make a three panel plot, one panel for each
species. Within each panel, we’ll plot the penguins’ bill lengths
vs. their flipper lengths:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Set up the plot area</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">1</span><span class="op">)</span>, mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">4</span>, <span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Loop over the species and create a plot for each one</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">species_split</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">species_data</span> <span class="op">&lt;-</span> <span class="va">species_split</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">species_data</span><span class="op">$</span><span class="va">bill_length_mm</span>, y <span class="op">=</span> <span class="va">species_data</span><span class="op">$</span><span class="va">flipper_length_mm</span>,</span>
<span>       xlab <span class="op">=</span> <span class="st">"Bill length (mm)"</span>, ylab <span class="op">=</span> <span class="st">"Flipper length (mm)"</span>,</span>
<span>       main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">species_split</span><span class="op">)</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>,</span>
<span>       xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">penguins_subset</span><span class="op">$</span><span class="va">bill_length_mm</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>       ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">penguins_subset</span><span class="op">$</span><span class="va">flipper_length_mm</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<div class="figure">
<img src="base-penguin-plot-1-1.png" alt="plot of chunk base-penguin-plot-1" width="100%"><p class="caption">
plot of chunk base-penguin-plot-1
</p>
</div>
<p>That’s a nice basic plot! But you know what would make it nicer? If
we added a penguin silhouette to the plot. Sadly, we don’t have a
different silhouette for each species (although we could make one…), so
let’s just go with putting a single silhouette in the top panel. To do
that, we can use the <code><a href="../reference/add_phylopic_base.html">add_phylopic_base()</a></code> function. Note
that the <code>x</code> and <code>y</code> arguments specify the center
of the silhouette, and the <code>height</code> argument specifies how
tall the silhouette is in the units of the y-axis.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Set up the plot area</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">1</span><span class="op">)</span>, mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">4</span>, <span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Loop over the species and create a plot for each one</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">species_split</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">species_data</span> <span class="op">&lt;-</span> <span class="va">species_split</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">species_data</span><span class="op">$</span><span class="va">bill_length_mm</span>, y <span class="op">=</span> <span class="va">species_data</span><span class="op">$</span><span class="va">flipper_length_mm</span>,</span>
<span>       xlab <span class="op">=</span> <span class="st">"Bill length (mm)"</span>, ylab <span class="op">=</span> <span class="st">"Flipper length (mm)"</span>,</span>
<span>       main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">species_split</span><span class="op">)</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>,</span>
<span>       xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">penguins_subset</span><span class="op">$</span><span class="va">bill_length_mm</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>       ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">penguins_subset</span><span class="op">$</span><span class="va">flipper_length_mm</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">i</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> <span class="fu"><a href="../reference/add_phylopic_base.html">add_phylopic_base</a></span><span class="op">(</span>img <span class="op">=</span> <span class="va">penguin_rot</span>, x <span class="op">=</span> <span class="fl">59</span>, y <span class="op">=</span> <span class="fl">215</span>, height <span class="op">=</span> <span class="fl">30</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<div class="figure">
<img src="base-penguin-plot-2-1.png" alt="plot of chunk base-penguin-plot-2" width="100%"><p class="caption">
plot of chunk base-penguin-plot-2
</p>
</div>
<p>Isn’t that nifty! We can go a step further, though. What if we used
little penguins instead of points?! To do that, we can once again use
the <code><a href="../reference/add_phylopic_base.html">add_phylopic_base()</a></code> function. In this case, we can
again specify <code>img = penguin_rot</code> since we want to use the
same image for each x-y pair:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Set up the plot area</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">1</span><span class="op">)</span>, mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">4</span>, <span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Loop over the species and create a plot for each one</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">species_split</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">species_data</span> <span class="op">&lt;-</span> <span class="va">species_split</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="cn">NA</span>, xlab <span class="op">=</span> <span class="st">"Bill length (mm)"</span>, ylab <span class="op">=</span> <span class="st">"Flipper length (mm)"</span>,</span>
<span>       main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">species_split</span><span class="op">)</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>,</span>
<span>       xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">penguins_subset</span><span class="op">$</span><span class="va">bill_length_mm</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>       ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">penguins_subset</span><span class="op">$</span><span class="va">flipper_length_mm</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="../reference/add_phylopic_base.html">add_phylopic_base</a></span><span class="op">(</span>img <span class="op">=</span> <span class="va">penguin_rot</span>,</span>
<span>                    x <span class="op">=</span> <span class="va">species_data</span><span class="op">$</span><span class="va">bill_length_mm</span>,</span>
<span>                    y <span class="op">=</span> <span class="va">species_data</span><span class="op">$</span><span class="va">flipper_length_mm</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<div class="figure">
<img src="base-penguin-plot-3-1.png" alt="plot of chunk base-penguin-plot-3" width="100%"><p class="caption">
plot of chunk base-penguin-plot-3
</p>
</div>
<p>Oh no, the silhouettes are way too big! The default for
<code><a href="../reference/add_phylopic_base.html">add_phylopic_base()</a></code> is to make the silhouette the same
height as the plot, which is way too big for our case here. Let’s make
the size of the silhouettes relative to the penguins’ body masses. A
scaling factor of 8 seems to work well for this size figure.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">1</span><span class="op">)</span>, mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">4</span>, <span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">species_split</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">species_data</span> <span class="op">&lt;-</span> <span class="va">species_split</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="cn">NA</span>, xlab <span class="op">=</span> <span class="st">"Bill length (mm)"</span>, ylab <span class="op">=</span> <span class="st">"Flipper length (mm)"</span>,</span>
<span>       main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">species_split</span><span class="op">)</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>,</span>
<span>       xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">penguins_subset</span><span class="op">$</span><span class="va">bill_length_mm</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>       ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">penguins_subset</span><span class="op">$</span><span class="va">flipper_length_mm</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="../reference/add_phylopic_base.html">add_phylopic_base</a></span><span class="op">(</span>img <span class="op">=</span> <span class="va">penguin_rot</span>,</span>
<span>                    x <span class="op">=</span> <span class="va">species_data</span><span class="op">$</span><span class="va">bill_length_mm</span>,</span>
<span>                    y <span class="op">=</span> <span class="va">species_data</span><span class="op">$</span><span class="va">flipper_length_mm</span>,</span>
<span>                    height <span class="op">=</span> <span class="va">species_data</span><span class="op">$</span><span class="va">body_mass_g</span> <span class="op">/</span></span>
<span>                      <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">penguins_subset</span><span class="op">$</span><span class="va">body_mass_g</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">*</span> <span class="fl">8</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<div class="figure">
<img src="base-penguin-plot-4-1.png" alt="plot of chunk base-penguin-plot-4" width="100%"><p class="caption">
plot of chunk base-penguin-plot-4
</p>
</div>
<p>Finally, let’s give the female and male penguins different fill
colors. We’ll also add a legend to the last panel.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">1</span><span class="op">)</span>, mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">4</span>, <span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">species_split</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">species_data</span> <span class="op">&lt;-</span> <span class="va">species_split</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="cn">NA</span>, xlab <span class="op">=</span> <span class="st">"Bill length (mm)"</span>, ylab <span class="op">=</span> <span class="st">"Flipper length (mm)"</span>,</span>
<span>       main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">species_split</span><span class="op">)</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>,</span>
<span>       xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">penguins_subset</span><span class="op">$</span><span class="va">bill_length_mm</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>       ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">penguins_subset</span><span class="op">$</span><span class="va">flipper_length_mm</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="../reference/add_phylopic_base.html">add_phylopic_base</a></span><span class="op">(</span>img <span class="op">=</span> <span class="va">penguin_rot</span>,</span>
<span>                    x <span class="op">=</span> <span class="va">species_data</span><span class="op">$</span><span class="va">bill_length_mm</span>,</span>
<span>                    y <span class="op">=</span> <span class="va">species_data</span><span class="op">$</span><span class="va">flipper_length_mm</span>,</span>
<span>                    height <span class="op">=</span> <span class="va">species_data</span><span class="op">$</span><span class="va">body_mass_g</span> <span class="op">/</span></span>
<span>                      <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">penguins_subset</span><span class="op">$</span><span class="va">body_mass_g</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">*</span> <span class="fl">8</span>,</span>
<span>                    fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">species_data</span><span class="op">$</span><span class="va">sex</span> <span class="op">==</span> <span class="st">"male"</span>, <span class="st">"blue"</span>, <span class="st">"orange"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Add a legend to the last plot</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"bottomright"</span>, legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Female"</span>, <span class="st">"Male"</span><span class="op">)</span>, pch <span class="op">=</span> <span class="fl">20</span>,</span>
<span>       col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"orange"</span>, <span class="st">"blue"</span><span class="op">)</span>, bty <span class="op">=</span> <span class="st">"n"</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="base-penguin-plot-5-1.png" alt="plot of chunk base-penguin-plot-5" width="100%"><p class="caption">
plot of chunk base-penguin-plot-5
</p>
</div>
<p>Now that’s a nice figure!</p>
</div>
<div class="section level2">
<h2 id="geographic-distribution">Geographic distribution<a class="anchor" aria-label="anchor" href="#geographic-distribution"></a>
</h2>
<p>In much the same way as generic x-y plotting, the
<strong>rphylopic</strong> package can be used in base R to plot
organism silhouettes on a map. That is, to plot data points (e.g.,
species occurrences) as silhouettes. We provide an example here of how
this might be achieved. For this application, we use the example
occurrence dataset of early (Carboniferous to Early Triassic) tetrapods
from the <a href="https://palaeoverse.palaeoverse.org" class="external-link">palaeoverse</a> R package to visualize the
geographic distribution of <em>Diplocaulus</em> fossils.</p>
<p>First, let’s load our libraries and the tetrapod data:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load libraries</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rphylopic.palaeoverse.org">rphylopic</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/adeckmyn/maps" class="external-link">maps</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://palaeoverse.palaeoverse.org" class="external-link">palaeoverse</a></span><span class="op">)</span></span>
<span><span class="co"># Get occurrence data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">tetrapods</span><span class="op">)</span></span></code></pre></div>
<p>Then we’ll subset our occurrences to only those for
<em>Diplocaulus</em>:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Subset to desired group</span></span>
<span><span class="va">tetrapods</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">tetrapods</span>, <span class="va">genus</span> <span class="op">==</span> <span class="st">"Diplocaulus"</span><span class="op">)</span></span></code></pre></div>
<p>Now, let’s plot those occurrences on a world map. Here we use the
<code>{geodata}</code> and <a href="https://rspatial.org/raster" class="external-link">raster</a> packages to generate
the map. Then we add colored points on top of this. Note that we use
<code>alpha = 0.75</code> in case there are multiple occurrences in the
same place. That way, the darker the color, the more occurrences in that
geographic location.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot map</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/maps/man/map.html" class="external-link">map</a></span><span class="op">(</span><span class="st">"world"</span>, col <span class="op">=</span> <span class="st">"lightgrey"</span>, fill <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co"># Plot points</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">tetrapods</span><span class="op">$</span><span class="va">lng</span>, y <span class="op">=</span> <span class="va">tetrapods</span><span class="op">$</span><span class="va">lat</span>, cex <span class="op">=</span> <span class="fl">2</span>, pch <span class="op">=</span> <span class="fl">16</span>,</span>
<span>       col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html" class="external-link">rgb</a></span><span class="op">(</span>red <span class="op">=</span> <span class="fl">0</span>, green <span class="op">=</span> <span class="fl">0</span>, blue <span class="op">=</span> <span class="fl">1</span>, alpha <span class="op">=</span> <span class="fl">0.75</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="base-geog-plot-1-1.png" alt="plot of chunk base-geog-plot-1" width="100%"><p class="caption">
plot of chunk base-geog-plot-1
</p>
</div>
<p>Now, as with the penguin figure above, we can easily replace those
points with silhouettes.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/maps/man/map.html" class="external-link">map</a></span><span class="op">(</span><span class="st">"world"</span>, col <span class="op">=</span> <span class="st">"lightgrey"</span>, fill <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/add_phylopic_base.html">add_phylopic_base</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Diplocaulus"</span>, x <span class="op">=</span> <span class="va">tetrapods</span><span class="op">$</span><span class="va">lng</span>, y <span class="op">=</span> <span class="va">tetrapods</span><span class="op">$</span><span class="va">lat</span>,</span>
<span>                  height <span class="op">=</span> <span class="fl">8</span>, fill <span class="op">=</span> <span class="st">"blue"</span>, alpha <span class="op">=</span> <span class="fl">0.75</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="base-geog-plot-2-1.png" alt="plot of chunk base-geog-plot-2" width="100%"><p class="caption">
plot of chunk base-geog-plot-2
</p>
</div>
<p>Snazzy!</p>
<p>Note that we used the genus name as the <code>name</code> argument
here. However, if we were plotting occurrences of multiple genera, we’d
definitely want to plot them as different silhouettes using
<code>name = tetrapods$genus</code>.</p>
</div>
<div class="section level2">
<h2 id="phylogenetics">Phylogenetics<a class="anchor" aria-label="anchor" href="#phylogenetics"></a>
</h2>
<p>Another common use case of PhyloPic silhouettes is to represent
taxonomic information. In this example, we demonstrate how to use
silhouettes within a phylogenetic framework. In this case, the
phylogeny, taken from the <a href="https://github.com/liamrevell/phytools" class="external-link">phytools</a> package, includes taxa
across all vertebrates. Even many taxonomic experts are unlikely to know
the scientific names of these 11 disparate taxa, so we’ll replace the
names with PhyloPic silhouettes. First, let’s load our libraries and
data:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load libraries</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rphylopic.palaeoverse.org">rphylopic</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/liamrevell/phytools" class="external-link">phytools</a></span><span class="op">)</span></span>
<span><span class="co"># Get vertebrate phylogeny and data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">vertebrate.tree</span><span class="op">)</span></span></code></pre></div>
<p>We can use a vectorized version of the <code><a href="../reference/get_uuid.html">get_uuid()</a></code>
function to retrieve UUID values for all of the species at once.
However, just in case we get an error, we wrap the
<code><a href="../reference/get_uuid.html">get_uuid()</a></code> call in a <code><a href="https://rdrr.io/r/base/conditions.html" class="external-link">tryCatch()</a></code> call. This
way, we should get either a UUID or <code>NA</code> for each
species:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Make a data.frame for the PhyloPic names</span></span>
<span><span class="va">vertebrate_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>species <span class="op">=</span> <span class="va">vertebrate.tree</span><span class="op">$</span><span class="va">tip.label</span>, uuid <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span></span>
<span><span class="co"># Try to get PhyloPic UUIDs for the species names</span></span>
<span><span class="va">vertebrate_data</span><span class="op">$</span><span class="va">uuid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">vertebrate.tree</span><span class="op">$</span><span class="va">tip.label</span>,</span>
<span>                               <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>                                 <span class="kw"><a href="https://rdrr.io/r/base/conditions.html" class="external-link">tryCatch</a></span><span class="op">(</span><span class="fu"><a href="../reference/get_uuid.html">get_uuid</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, error <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">e</span><span class="op">)</span> <span class="cn">NA</span><span class="op">)</span></span>
<span>                               <span class="op">}</span><span class="op">)</span></span>
<span><span class="va">vertebrate_data</span></span></code></pre></div>
<pre><code><span><span class="co">##                   species                                 uuid</span></span>
<span><span class="co">## 1  Carcharodon_carcharias 00f208a3-887d-4ae8-838c-2124f53b9fc1</span></span>
<span><span class="co">## 2       Carassius_auratus abcb9d2c-db21-4b63-b8e7-b770b11ad288</span></span>
<span><span class="co">## 3     Latimeria_chalumnae 12c38a8a-6d68-4af3-ada3-05cafdfc25c2</span></span>
<span><span class="co">## 4            Homo_sapiens 9c6af553-390c-4bdd-baeb-6992cbc540b1</span></span>
<span><span class="co">## 5             Lemur_catta 8a187391-82a3-4d9b-a402-3a310bf7dc38</span></span>
<span><span class="co">## 6        Myotis_lucifugus                                 &lt;NA&gt;</span></span>
<span><span class="co">## 7              Sus_scrofa 3d8acaf6-4355-491e-8e86-4a411b53b98b</span></span>
<span><span class="co">## 8  Megaptera_novaeangliae 012afb33-55c3-4fc6-9ae3-3a91fda32fd5</span></span>
<span><span class="co">## 9              Bos_taurus dc5c561e-e030-444d-ba22-3d427b60e58a</span></span>
<span><span class="co">## 10          Iguana_iguana 5dec03d9-66a2-4033-b1a9-6dbb3485199f</span></span>
<span><span class="co">## 11     Turdus_migratorius 83b29bf0-f4f9-412d-8b3b-7faf4febd69d</span></span></code></pre>
<p>Oh no, we weren’t able to find a silhouette for <em>Myotis
lucifugus</em> (little brown bat)! Good thing we used
<code><a href="https://rdrr.io/r/base/conditions.html" class="external-link">tryCatch()</a></code>! Given the coarse resolution of this phylogeny,
we can just grab a silhouette for the subfamily (Vespertilioninae):</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">vertebrate_data</span><span class="op">$</span><span class="va">uuid</span><span class="op">[</span><span class="va">vertebrate_data</span><span class="op">$</span><span class="va">species</span> <span class="op">==</span> <span class="st">"Myotis_lucifugus"</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/get_uuid.html">get_uuid</a></span><span class="op">(</span><span class="st">"Vespertilioninae"</span><span class="op">)</span></span></code></pre></div>
<p>I’m also not a huge fan of the boar picture. Let’s choose an
alternative with <code><a href="../reference/pick_phylopic.html">pick_phylopic()</a></code>.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Pick a different boar image; we'll pick #2</span></span>
<span><span class="va">boar_svg</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pick_phylopic.html">pick_phylopic</a></span><span class="op">(</span><span class="st">"Sus scrofa"</span>, view <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span><span class="co"># Extract the UUID</span></span>
<span><span class="va">vertebrate_data</span><span class="op">$</span><span class="va">uuid</span><span class="op">[</span><span class="va">vertebrate_data</span><span class="op">$</span><span class="va">species</span> <span class="op">==</span> <span class="st">"Sus_scrofa"</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">boar_svg</span>, <span class="st">"uuid"</span><span class="op">)</span></span></code></pre></div>
<p>Now that we’ve got our phylogeny and UUIDs, we could go ahead and
create our figure. However, time for a quick aside. The time required
for <code><a href="../reference/add_phylopic_base.html">add_phylopic_base()</a></code> and the other
<strong>rphylopic</strong> visualization functions scales with the
number of <em>unique</em> names/UUIDs, not the number of plotted
silhouettes. Therefore, if you are plotting a lot of <em>different</em>
silhouettes, these functions can take quite a long time to poll PhyloPic
for each unique name, download the silhouettes, and convert them to be
added to the plot. If you plan to use the same silhouettes for multiple
figures, we strongly suggest that you poll PhyloPic yourself using
<code><a href="../reference/get_phylopic.html">get_phylopic()</a></code> or <code><a href="../reference/pick_phylopic.html">pick_phylopic()</a></code>, save the
silhouettes to your R environment, and then these use image objects in
the visualization functions (with the <code>img</code>
argument/aesthetic). Following this advice, let’s get image objects for
these 11 species before we make our figure. Note that, since we’ve used
<code><a href="../reference/get_uuid.html">get_uuid()</a></code> to get these 11 UUIDs, we know that they are
valid, so we don’t need to catch any errors this time.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">vertebrate_data</span><span class="op">$</span><span class="va">svg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">vertebrate_data</span><span class="op">$</span><span class="va">uuid</span>, <span class="va">get_phylopic</span><span class="op">)</span></span></code></pre></div>
<p>Now let’s go ahead and plot our phylogeny with the <a href="https://github.com/emmanuelparadis/ape" class="external-link">ape</a>
package:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/emmanuelparadis/ape" class="external-link">ape</a></span><span class="op">)</span></span>
<span><span class="co"># Plot the tree</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">vertebrate.tree</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="base-phylo-plot-1-1.png" alt="plot of chunk base-phylo-plot-1" width="100%"><p class="caption">
plot of chunk base-phylo-plot-1
</p>
</div>
<p>Hmm…that’s a bit boring. Let’s add a geological timescale to the
bottom using <code><a href="https://palaeoverse.palaeoverse.org/reference/axis_geo.html" class="external-link">axis_geo_phylo()</a></code> from the
<a href="https://palaeoverse.palaeoverse.org" class="external-link">palaeoverse</a> package.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://palaeoverse.palaeoverse.org" class="external-link">palaeoverse</a></span><span class="op">)</span></span>
<span><span class="co"># Plot the tree with a geological timescale on the bottom</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">vertebrate.tree</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://palaeoverse.palaeoverse.org/reference/axis_geo.html" class="external-link">axis_geo_phylo</a></span><span class="op">(</span>intervals <span class="op">=</span> <span class="st">"periods"</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="base-phylo-plot-2-1.png" alt="plot of chunk base-phylo-plot-2" width="100%"><p class="caption">
plot of chunk base-phylo-plot-2
</p>
</div>
<p>That’s looking a lot prettier! Let’s go ahead and replace the tip
labels with our silhouettes now using <code><a href="../reference/add_phylopic_base.html">add_phylopic_base()</a></code>.
Note that while it may look like all of the tips have an x-axis value of
0, that’s actually a trick from <code><a href="https://palaeoverse.palaeoverse.org/reference/axis_geo.html" class="external-link">axis_geo_phylo()</a></code>. In
reality, the left end of the x-axis is 0, and the right end of the
x-axis is the total height of the tree. We can calculate this using the
<code><a href="https://rdrr.io/pkg/phytools/man/nodeHeights.html" class="external-link">nodeHeights()</a></code> function.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">vertebrate.tree</span>, show.tip.label <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://palaeoverse.palaeoverse.org/reference/axis_geo.html" class="external-link">axis_geo_phylo</a></span><span class="op">(</span>intervals <span class="op">=</span> <span class="st">"periods"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/add_phylopic_base.html">add_phylopic_base</a></span><span class="op">(</span>img <span class="op">=</span> <span class="va">vertebrate_data</span><span class="op">$</span><span class="va">svg</span>,</span>
<span>                  x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/phytools/man/nodeHeights.html" class="external-link">nodeHeights</a></span><span class="op">(</span><span class="va">vertebrate.tree</span><span class="op">)</span><span class="op">)</span>, y <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">11</span>, height <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="base-phylo-plot-3-1.png" alt="plot of chunk base-phylo-plot-3" width="100%"><p class="caption">
plot of chunk base-phylo-plot-3
</p>
</div>
<p>Note that only a single size is specified and aspect ratio is always
maintained, hence why the silhouettes all have the same height but
different widths. Let’s fix some of the silhouettes by rotating them 90
degrees:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">vertebrate_data</span><span class="op">$</span><span class="va">svg</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rotate_phylopic.html">rotate_phylopic</a></span><span class="op">(</span>img <span class="op">=</span> <span class="va">vertebrate_data</span><span class="op">$</span><span class="va">svg</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">vertebrate_data</span><span class="op">$</span><span class="va">svg</span><span class="op">[[</span><span class="fl">8</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rotate_phylopic.html">rotate_phylopic</a></span><span class="op">(</span>img <span class="op">=</span> <span class="va">vertebrate_data</span><span class="op">$</span><span class="va">svg</span><span class="op">[[</span><span class="fl">8</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<p>And now the finished product:</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">vertebrate.tree</span>, show.tip.label <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://palaeoverse.palaeoverse.org/reference/axis_geo.html" class="external-link">axis_geo_phylo</a></span><span class="op">(</span>intervals <span class="op">=</span> <span class="st">"periods"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/add_phylopic_base.html">add_phylopic_base</a></span><span class="op">(</span>img <span class="op">=</span> <span class="va">vertebrate_data</span><span class="op">$</span><span class="va">svg</span>,</span>
<span>                  x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/phytools/man/nodeHeights.html" class="external-link">nodeHeights</a></span><span class="op">(</span><span class="va">vertebrate.tree</span><span class="op">)</span><span class="op">)</span>, y <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">11</span>, height <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="base-phylo-plot-4-1.png" alt="plot of chunk base-phylo-plot-4" width="100%"><p class="caption">
plot of chunk base-phylo-plot-4
</p>
</div>
<p>Beautiful!</p>
</div>
</div>
<style type="text/css">
p.caption {
  display: none;
}
</style></main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://williamgearty.com" class="external-link">William Gearty</a>, <a href="https://www.lewisajones.com" class="external-link">Lewis A. Jones</a>, Scott Chamberlain.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
